<h1>
    Simple recording demo

</h1>
<button id="btn-start-recording">Start Recording</button>
<button id="btn-stop-recording" >Stop Recording</button>
<button id="btn-release-microphone" >Release Microphone</button>
<script src="node_modules/recordrtc/RecordRTC.js"></script>



<script>
    import "fs";

    var recorder; // globally accessible
    var mic;

    var start_btn = document.getElementById("btn-start-recording");
    var end_btn = document.getElementById("btn-stop-recording");


    start_btn.onclick = function(){


        navigator.mediaDevices.getUserMedia({
            audio: true
        }).then(async function(stream) {
            
            mic = stream;
            
            recorder = RecordRTC(stream, {
                type: 'audio'
            });
            recorder.startRecording();
    
     
    });
};


    end_btn.onclick = function(){
        
        // Initiates stop recording and saves file 
        recorder.stopRecording(function() {
            let blob = recorder.getBlob();
            
            blob.lastModifiedDate = new Date();
            blob.name = "audio_temp.wav";
            console.log(blob);
            // invokeSaveAsDialog(blob,"audio.wav");
            fs.writeFile('audio_temp.wav', blob, function (err) {
                if (err) throw err;
                console.log('Saved!');  
            });

        });

        // This releases the mic
        mic.stop();

    }


</script>